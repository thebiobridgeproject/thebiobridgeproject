<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resource Hub – The BioBridge Project</title>
  <style>
    /* [Styling omitted for brevity — same as your original styles] */
    /* You can keep your full CSS here as-is */
  </style>
</head>
<body>
  <header>
    <nav>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="projects.html">Projects</a></li>
        <li><a href="resource-hub.html" class="active">Resource Hub</a></li>
        <li><a href="essay-analyzer.html">Essay Analyzer</a></li>
        <li><a href="volunteer.html">Volunteer</a></li>
        <li><a href="events.html">Events</a></li>
      </ul>
      <a href="#" class="login-btn">Log In</a>
    </nav>
  </header>

  <section class="page-hero">
    <div class="container">
      <h1>Resource Hub</h1>
      <p>Share and discover valuable STEM resources for all ages.</p>
    </div>
  </section>

  <section class="resource-form-section">
    <h3>Submit a New STEM Resource</h3>
    <form class="resource-form" id="resourceForm" autocomplete="off">
      <label for="resourceName">Resource Name</label>
      <input type="text" id="resourceName" required maxlength="100" placeholder="e.g. Interactive Cell Explorer" />

      <label for="resourceLink">Resource Link (URL)</label>
      <input type="url" id="resourceLink" required maxlength="250" placeholder="e.g. https://example.com" />

      <label for="resourceDesc">Description</label>
      <textarea id="resourceDesc" required maxlength="300" placeholder="Briefly describe the resource..."></textarea>

      <button type="submit">Add Resource</button>
    </form>
  </section>

  <section class="resource-hub-content">
    <div class="container">
      <div class="resources-list" id="resourcesList">
        <div class="empty-note" id="emptyNote">No resources yet. Be the first to add one!</div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="footer-links">
        <a href="index.html">Home</a>
        <a href="projects.html">Projects</a>
        <a href="resource-hub.html" class="active">Resource Hub</a>
        <a href="essay-analyzer.html">Essay Analyzer</a>
        <a href="volunteer.html">Volunteer</a>
        <a href="events.html">Events</a>
      </div>
      <p>© 2024 The BioBridge Project</p>
    </div>
  </footer>

  <script>
    const resourceForm = document.getElementById('resourceForm');
    const resourcesList = document.getElementById('resourcesList');
    const emptyNote = document.getElementById('emptyNote');

    const API_URL = 'https://script.google.com/macros/s/AKfycbzxmfEHqpeyeMHXiYt7PE-UqUZnKS8vwOOgYXbNaKlN1M0tTbKLncz3GLUXREPJoeGr/exec';

    let resources = [];

    function renderResources() {
      resourcesList.innerHTML = '';
      if (resources.length === 0) {
        resourcesList.appendChild(emptyNote);
        emptyNote.style.display = 'block';
      } else {
        emptyNote.style.display = 'none';
        resources.forEach(res => {
          const div = document.createElement('div');
          div.className = 'resource-item';
          div.innerHTML = `
            <h4>${escapeHTML(res.name)}</h4>
            <p>${escapeHTML(res.desc)}</p>
            <a href="${escapeHTML(res.link)}" target="_blank">${escapeHTML(res.link)}</a>
          `;
          resourcesList.appendChild(div);
        });
      }
    }

    function escapeHTML(str) {
      return str.replace(/[&<>\"']/g, function(m) {
        return {
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        }[m];
      });
    }

    async function fetchResources() {
      try {
        const res = await fetch(API_URL);
        if (!res.ok) throw new Error('Failed to fetch resources');
        resources = await res.json();
      } catch (e) {
        resources = [];
      }
      renderResources();
    }

    resourceForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      const name = document.getElementById('resourceName').value.trim();
      const link = document.getElementById('resourceLink').value.trim();
      const desc = document.getElementById('resourceDesc').value.trim();

      if (!/^https?:\/\//i.test(link)) {
        alert('Please enter a valid URL starting with http:// or https://');
        return;
      }

      try {
        await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, link, desc })
        });
        resourceForm.reset();
        await fetchResources();
      } catch (err) {
        alert('Failed to submit resource. Please try again.');
      }
    });

    fetchResources();
  </script>
</body>
</html>
